from shapely.geometry import *
import numpy as np
from shapely import wkb

class ClassBradley:

    def __init__(self,geom):
        self.grav=9.81
        self.polyS=wkb.loads(geom, hex=True)
        self.DEBUG=True

    def cacl_hn(self, q, ks, pente):
        """ks strickler coef
            q flowrate per unit of width """
        return (q / (ks * pente ** 0.5)) ** 0.6

    def cacl_flowrate(self, q, ks, pente,s_w,p_w):
        """ks strickler coef
            q flowrate per unit of width """


        cacl_umoy(s_w, p_w, ks, pente)
        return (q / (ks * pente ** 0.5)) ** 0.6



    def cacl_hc(self, q):
        return (q ** 2 / self.grav) ** (1 / 3.)


    def cacl_umoy(self, s_w, p_w, ks, pente):
        """ s_w wet surface
            p_w wet perimeter """
        return ks * pente ** 0.5 * (s_w / p_w) ** (2 / 3.)


    def bradley(self,cote,deb,):
        pass
        # debit, heau
        # cote plateform

    # largeur pile
    # lougeur pile
    # pile bias ?
    # nombre de pile
    # bias de l'ouvrage
    # type cule
    # epaisseur tablier
if __name__ == '__main__':
    geom="010300000001000000E90000000000000000004E40FC4480D6F60265400000000000004E407B14AE47E1726A4000000000004075407B14AE47E1726A40000000000040754048E17A14AE676540CDCCCCCCCC247540E17A14AE476165400000000000107540F6285C8FC25D65403333333333FB74407B14AE47E15A65406666666666DE7440CDCCCCCCCC5C65400000000000D07440AE47E17A145E65406666666666AE744014AE47E17A5C65406666666666A67440EC51B81E855B654066666666667E74408FC2F5285C4F654033333333337B744066666666664E65409A99999999697440D7A3703D0A476540000000000050744014AE47E17A3C6540CDCCCCCCCC4C7440EC51B81E853B65406666666666267440AE47E17A143665409A999999992174406666666666366540CDCCCCCCCC1C7440F6285C8FC23565403333333333FB7340E17A14AE47316540CDCCCCCCCCF47340B81E85EB51306540CDCCCCCCCCEC73408FC2F5285C2F65409A99999999D17340A4703D0AD72B65403333333333BB734052B81E85EB2965406666666666A67340000000000028654033333333338B73409A9999999921654033333333337B7340AE47E17A141E654033333333335B7340B81E85EB511865409A999999995173408FC2F5285C1765409A99999999297340D7A3703D0A1765406666666666267340D7A3703D0A17654000000000001073401F85EB51B8166540CDCCCCCCCCFC724066666666661665403333333333FB724066666666661665409A99999999F9724066666666661665409A99999999D17240F6285C8FC21565409A99999999C972403D0AD7A3701565406666666666A6724085EB51B81E1565400000000000987240CDCCCCCCCC146540CDCCCCCCCC7C7240A4703D0AD713654000000000006872407B14AE47E11265409A999999995172409A99999999116540000000000038724048E17A14AE0F654000000000002872408FC2F5285C0F6540000000000018724066666666660E654066666666660672401F85EB51B80E65409A999999990172401F85EB51B80E6540CDCCCCCCCCFC714066666666660E65406666666666D671405C8FC2F5280C65409A99999999D17140A4703D0AD70B6540CDCCCCCCCCB4714085EB51B81E0D65400000000000A87140F6285C8FC20D65406666666666A67140F6285C8FC20D6540CDCCCCCCCC7C7140AE47E17A140E6540CDCCCCCCCC7471403D0AD7A3700D65403333333333537140EC51B81E850B6540CDCCCCCCCC447140EC51B81E850B65400000000000287140CDCCCCCCCC0C6540CDCCCCCCCC14714085EB51B81E0D654000000000000871405C8FC2F5280C6540CDCCCCCCCCFC70407B14AE47E10A65403333333333E370400AD7A3703D0A65403333333333D370409A999999990965403333333333B3704000000000000865400000000000A870408FC2F5285C0765403333333333837040EC51B81E8503654066666666667E70407B14AE47E102654033333333335B70406666666666FE644033333333335370403D0AD7A370FD64409A999999995170403D0AD7A370FD6440CDCCCCCCCC3C70405C8FC2F528FC644000000000002870407B14AE47E1FA64409A9999999921704052B81E85EBF96440CDCCCCCCCCFC6F4014AE47E17AF464403333333333E36F4052B81E85EBF164403333333333C36F40D7A3703D0AEF64406666666666A66F403333333333EB64406666666666966F40E17A14AE47E964400000000000806F406666666666E664403333333333536F40E17A14AE47E164400000000000206F40F6285C8FC2DD6440CDCCCCCCCCFC6E405C8FC2F528DC64400000000000C06E40B81E85EB51D864406666666666A66E40D7A3703D0AD76440CDCCCCCCCC5C6E403333333333D364403333333333536E407B14AE47E1D264403333333333036E40EC51B81E85D36440CDCCCCCCCCFC6D40EC51B81E85D364409A99999999A96D405C8FC2F528DC6440CDCCCCCCCC9C6D40AE47E17A14DE64403333333333536D4052B81E85EBE964409A99999999396D403D0AD7A370ED6440CDCCCCCCCCFC6C40CDCCCCCCCCF46440CDCCCCCCCCEC6C401F85EB51B8F664409A99999999D96C400000000000F864400000000000C06C4052B81E85EBF964409A99999999A96C403333333333FB64409A99999999796C403D0AD7A370FD64403333333333536C40AE47E17A14FE64406666666666166C406666666666FE64400000000000006C406666666666FE64406666666666B66B401F85EB51B8FE64409A99999999A96B401F85EB51B8FE64406666666666566B40295C8FC2F50065403333333333536B40295C8FC2F5006540CDCCCCCCCC4C6B40295C8FC2F50065400000000000006B4052B81E85EB0165403333333333F36A4052B81E85EB0165409A99999999A96A405C8FC2F5280465403333333333936A4085EB51B81E0565406666666666566A4066666666660665403333333333336A40D7A3703D0A0765400000000000006A4000000000000865400000000000D06940295C8FC2F50865409A99999999A96940713D0AD7A30865400000000000706940D7A3703D0A076540666666666656694066666666660665400000000000106940F6285C8FC20565400000000000006940F6285C8FC20565409A99999999D968408FC2F5285C076540CDCCCCCCCCAC6840295C8FC2F50865409A99999999996840295C8FC2F50865406666666666566840E17A14AE47096540CDCCCCCCCC4C6840295C8FC2F50865400000000000006840E17A14AE47096540CDCCCCCCCCEC67409A99999999096540CDCCCCCCCCAC6740295C8FC2F50865409A99999999896740E17A14AE470965406666666666566740E17A14AE470965409A99999999296740000000000008654033333333331367408FC2F5285C07654033333333330367401F85EB51B80665406666666666E6664066666666660665409A99999999C96640F6285C8FC2056540CDCCCCCCCCAC66403D0AD7A370056540666666666666664033333333330365406666666666566640C3F5285C8F0265406666666666066640E17A14AE470165403333333333036640E17A14AE470165406666666666E66540295C8FC2F5006540CDCCCCCCCCAC6540B81E85EB510065406666666666A66540713D0AD7A30065409A9999999959654014AE47E17A0465400000000000506540CDCCCCCCCC046540333333333343654085EB51B81E05654000000000002065401F85EB51B80665403333333333036540D7A3703D0A0765403333333333E36440D7A3703D0A076540CDCCCCCCCCAC644085EB51B81E056540333333333383644033333333330365409A9999999959644052B81E85EB0165400000000000206440B81E85EB5100654033333333330364408FC2F5285CFF64400000000000C06340F6285C8FC2FD64400000000000B063403D0AD7A370FD64400000000000606340A4703D0AD7FB64409A99999999596340A4703D0AD7FB64400000000000306340A4703D0AD7FB64403333333333036340A4703D0AD7FB6440CDCCCCCCCCFC6240A4703D0AD7FB64400000000000B06240A4703D0AD7FB6440CDCCCCCCCC9C6240A4703D0AD7FB64409A999999995962400AD7A3703DFA6440CDCCCCCCCC3C6240E17A14AE47F9644066666666660662400000000000F864409A99999999D96140D7A3703D0AF764400000000000B06140AE47E17A14F6644066666666669661401F85EB51B8F664409A999999997961406666666666F664409A999999996961406666666666F664409A999999995961403D0AD7A370F564409A99999999196140A4703D0AD7F3644066666666660661403333333333F364406666666666B660400000000000F064400000000000B060400000000000F06440CDCCCCCCCC7C6040D7A3703D0AEF6440CDCCCCCCCC5C60406666666666EE644066666666665660406666666666EE644066666666660660403333333333EB6440CDCCCCCCCCEC5F407B14AE47E1EA64400000000000605F409A99999999E964406666666666265F40295C8FC2F5E864409A99999999B95E40713D0AD7A3E864406666666666665E400000000000E86440CDCCCCCCCC0C5E408FC2F5285CE764406666666666A65D409A99999999E964400000000000805D40C3F5285C8FEA64400000000000605D403333333333EB64406666666666265D40AE47E17A14EE64400000000000E05C400000000000F064409A99999999B95C408FC2F5285CEF64400000000000205C4048E17A14AEE76440CDCCCCCCCC0C5C408FC2F5285CE764409A99999999B95B40A4703D0AD7E364406666666666665B40C3F5285C8FE264400000000000605B40C3F5285C8FE264409A99999999B95A40C3F5285C8FE264409A99999999995A400AD7A3703DE26440CDCCCCCCCC0C5A40E17A14AE47E164409A99999999D95940713D0AD7A3E064406666666666665940B81E85EB51E064409A99999999195940295C8FC2F5E064409A99999999B958403333333333E36440333333333353584048E17A14AEE7644033333333331358403333333333EB64403333333333935740E17A14AE47F164406666666666665740C3F5285C8FF264403333333333D35640D7A3703D0AF764409A99999999B956408FC2F5285CF7644066666666662656400000000000F8644033333333331356400000000000F86440CDCCCCCCCC0C56400000000000F8644066666666666655403D0AD7A370F56440CDCCCCCCCC4C554085EB51B81EF564400000000000C05440EC51B81E85F36440CDCCCCCCCC8C54403333333333F3644033333333331354403333333333F364406666666666C65340A4703D0AD7F3644033333333339353405C8FC2F528F464406666666666665340A4703D0AD7F364406666666666065340CDCCCCCCCCF464400000000000C05240F6285C8FC2F564406666666666465240D7A3703D0AF764403333333333135240D7A3703D0AF764400000000000805140713D0AD7A3F86440CDCCCCCCCC6C5140295C8FC2F5F864400000000000C050403333333333FB6440333333333313504085EB51B81EFD6440CDCCCCCCCC0C50403D0AD7A370FD644000000000000050403D0AD7A370FD64409A99999999D94E4000000000000065403333333333734E409A999999990165400000000000004E40FC4480D6F6026540"
    cl=ClassCalcMeth(geom)
    (minx, miny, maxx, maxy) = cl.polyS.bounds
    print(minx, miny, maxx, maxy)
    list_hn=list(np.arange(miny,maxy,0.1))
    list_Q=[]


    # var general
    pente=0.00008
    ks=30

    #****
    print(list_hn)
    print(cl.polyS)
    cote=197.78
    polyw=cl.calc_polyw(cl.polyS,cote)
    s_w = polyw.area
    p_w = polyw.length
    cacl_umoy(s_w, p_w, ks, pente)

    print(s_w,p_w)

    pass
